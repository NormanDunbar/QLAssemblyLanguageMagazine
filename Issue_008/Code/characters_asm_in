UPPERCASE    equ 1     ; Bit 0 = A - Z
LOWERCASE    equ 2     ; Bit 1 = a - z
DIGIT        equ 4     ; Bit 2 = 0 - 9
SPACE        equ 8     ; Bit 3 = space tab etc
PUNCTUATION  equ 16    ; Bit 4 = .,;: etc
CONTROL      equ 32    ; Bit 5 = Various
BLANK        equ 64    ; Bit 6 = space tab
HEXDIGIT     equ 128   ; Bit 7 = 0 - 9 a - f A - F
ALPHABETIC   equ UPPERCASE + LOWERCASE
ALPHANUMERIC equ ALPHABETIC + DIGIT
PRINTABLE    equ BLANK + PUNCTUATION + ALPHABETIC + DIGIT
GRAPHIC      equ PUNCTUATION + ALPHABETIC + DIGIT


chartab    dc.b 0 + CONTROL      ; CHR$(0) = '.'
           dc.b 0 + CONTROL      ; CHR$(1) = '.'
           dc.b 0 + CONTROL      ; CHR$(2) = '.'
           dc.b 0 + CONTROL      ; CHR$(3) = '.'
           dc.b 0 + CONTROL      ; CHR$(4) = '.'
           dc.b 0 + CONTROL      ; CHR$(5) = '.'
           dc.b 0 + CONTROL      ; CHR$(6) = '.'
           dc.b 0 + CONTROL      ; CHR$(7) = '.'
           dc.b 0 + CONTROL      ; CHR$(8) = '.'
           dc.b 0 + CONTROL + SPACE + BLANK      ; CHR$(9) = '.'
           dc.b 0 + CONTROL + SPACE      ; CHR$(10) = '.'
           dc.b 0 + CONTROL + SPACE      ; CHR$(11) = '.'
           dc.b 0 + CONTROL + SPACE      ; CHR$(12) = '.'
           dc.b 0 + CONTROL + SPACE      ; CHR$(13) = '.'
           dc.b 0 + CONTROL      ; CHR$(14) = '.'
           dc.b 0 + CONTROL      ; CHR$(15) = '.'
           dc.b 0 + CONTROL      ; CHR$(16) = '.'
           dc.b 0 + CONTROL      ; CHR$(17) = '.'
           dc.b 0 + CONTROL      ; CHR$(18) = '.'
           dc.b 0 + CONTROL      ; CHR$(19) = '.'
           dc.b 0 + CONTROL      ; CHR$(20) = '.'
           dc.b 0 + CONTROL      ; CHR$(21) = '.'
           dc.b 0 + CONTROL      ; CHR$(22) = '.'
           dc.b 0 + CONTROL      ; CHR$(23) = '.'
           dc.b 0 + CONTROL      ; CHR$(24) = '.'
           dc.b 0 + CONTROL      ; CHR$(25) = '.'
           dc.b 0 + CONTROL      ; CHR$(26) = '.'
           dc.b 0 + CONTROL      ; CHR$(27) = '.'
           dc.b 0 + CONTROL      ; CHR$(28) = '.'
           dc.b 0 + CONTROL      ; CHR$(29) = '.'
           dc.b 0 + CONTROL      ; CHR$(30) = '.'
           dc.b 0 + CONTROL      ; CHR$(31) = '.'
           dc.b 0 + SPACE + BLANK      ; CHR$(32) = ' '
           dc.b 0 + PUNCTUATION      ; CHR$(33) = '!'
           dc.b 0 + PUNCTUATION      ; CHR$(34) = '"'
           dc.b 0 + PUNCTUATION      ; CHR$(35) = '#'
           dc.b 0 + PUNCTUATION      ; CHR$(36) = '$'
           dc.b 0 + PUNCTUATION      ; CHR$(37) = '%'
           dc.b 0 + PUNCTUATION      ; CHR$(38) = '&'
           dc.b 0 + PUNCTUATION      ; CHR$(39) = '''
           dc.b 0 + PUNCTUATION      ; CHR$(40) = '('
           dc.b 0 + PUNCTUATION      ; CHR$(41) = ')'
           dc.b 0 + PUNCTUATION      ; CHR$(42) = '*'
           dc.b 0 + PUNCTUATION      ; CHR$(43) = '+'
           dc.b 0 + PUNCTUATION      ; CHR$(44) = ','
           dc.b 0 + PUNCTUATION      ; CHR$(45) = '-'
           dc.b 0 + PUNCTUATION      ; CHR$(46) = '.'
           dc.b 0 + PUNCTUATION      ; CHR$(47) = '/'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(48) = '0'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(49) = '1'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(50) = '2'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(51) = '3'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(52) = '4'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(53) = '5'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(54) = '6'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(55) = '7'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(56) = '8'
           dc.b 0 + DIGIT + HEXDIGIT      ; CHR$(57) = '9'
           dc.b 0 + PUNCTUATION      ; CHR$(58) = ':'
           dc.b 0 + PUNCTUATION      ; CHR$(59) = ';'
           dc.b 0 + PUNCTUATION      ; CHR$(60) = '<'
           dc.b 0 + PUNCTUATION      ; CHR$(61) = '='
           dc.b 0 + PUNCTUATION      ; CHR$(62) = '>'
           dc.b 0 + PUNCTUATION      ; CHR$(63) = '?'
           dc.b 0 + PUNCTUATION      ; CHR$(64) = '@'
           dc.b 0 + UPPERCASE + HEXDIGIT      ; CHR$(65) = 'A'
           dc.b 0 + UPPERCASE + HEXDIGIT      ; CHR$(66) = 'B'
           dc.b 0 + UPPERCASE + HEXDIGIT      ; CHR$(67) = 'C'
           dc.b 0 + UPPERCASE + HEXDIGIT      ; CHR$(68) = 'D'
           dc.b 0 + UPPERCASE + HEXDIGIT      ; CHR$(69) = 'E'
           dc.b 0 + UPPERCASE + HEXDIGIT      ; CHR$(70) = 'F'
           dc.b 0 + UPPERCASE      ; CHR$(71) = 'G'
           dc.b 0 + UPPERCASE      ; CHR$(72) = 'H'
           dc.b 0 + UPPERCASE      ; CHR$(73) = 'I'
           dc.b 0 + UPPERCASE      ; CHR$(74) = 'J'
           dc.b 0 + UPPERCASE      ; CHR$(75) = 'K'
           dc.b 0 + UPPERCASE      ; CHR$(76) = 'L'
           dc.b 0 + UPPERCASE      ; CHR$(77) = 'M'
           dc.b 0 + UPPERCASE      ; CHR$(78) = 'N'
           dc.b 0 + UPPERCASE      ; CHR$(79) = 'O'
           dc.b 0 + UPPERCASE      ; CHR$(80) = 'P'
           dc.b 0 + UPPERCASE      ; CHR$(81) = 'Q'
           dc.b 0 + UPPERCASE      ; CHR$(82) = 'R'
           dc.b 0 + UPPERCASE      ; CHR$(83) = 'S'
           dc.b 0 + UPPERCASE      ; CHR$(84) = 'T'
           dc.b 0 + UPPERCASE      ; CHR$(85) = 'U'
           dc.b 0 + UPPERCASE      ; CHR$(86) = 'V'
           dc.b 0 + UPPERCASE      ; CHR$(87) = 'W'
           dc.b 0 + UPPERCASE      ; CHR$(88) = 'X'
           dc.b 0 + UPPERCASE      ; CHR$(89) = 'Y'
           dc.b 0 + UPPERCASE      ; CHR$(90) = 'Z'
           dc.b 0 + PUNCTUATION      ; CHR$(91) = '['
           dc.b 0 + PUNCTUATION      ; CHR$(92) = '\'
           dc.b 0 + PUNCTUATION      ; CHR$(93) = ']'
           dc.b 0 + PUNCTUATION      ; CHR$(94) = '^'
           dc.b 0 + PUNCTUATION      ; CHR$(95) = '_'
           dc.b 0 + PUNCTUATION      ; CHR$(96) = '`'
           dc.b 0 + LOWERCASE + HEXDIGIT      ; CHR$(97) = 'a'
           dc.b 0 + LOWERCASE + HEXDIGIT      ; CHR$(98) = 'b'
           dc.b 0 + LOWERCASE + HEXDIGIT      ; CHR$(99) = 'c'
           dc.b 0 + LOWERCASE + HEXDIGIT      ; CHR$(100) = 'd'
           dc.b 0 + LOWERCASE + HEXDIGIT      ; CHR$(101) = 'e'
           dc.b 0 + LOWERCASE + HEXDIGIT      ; CHR$(102) = 'f'
           dc.b 0 + LOWERCASE      ; CHR$(103) = 'g'
           dc.b 0 + LOWERCASE      ; CHR$(104) = 'h'
           dc.b 0 + LOWERCASE      ; CHR$(105) = 'i'
           dc.b 0 + LOWERCASE      ; CHR$(106) = 'j'
           dc.b 0 + LOWERCASE      ; CHR$(107) = 'k'
           dc.b 0 + LOWERCASE      ; CHR$(108) = 'l'
           dc.b 0 + LOWERCASE      ; CHR$(109) = 'm'
           dc.b 0 + LOWERCASE      ; CHR$(110) = 'n'
           dc.b 0 + LOWERCASE      ; CHR$(111) = 'o'
           dc.b 0 + LOWERCASE      ; CHR$(112) = 'p'
           dc.b 0 + LOWERCASE      ; CHR$(113) = 'q'
           dc.b 0 + LOWERCASE      ; CHR$(114) = 'r'
           dc.b 0 + LOWERCASE      ; CHR$(115) = 's'
           dc.b 0 + LOWERCASE      ; CHR$(116) = 't'
           dc.b 0 + LOWERCASE      ; CHR$(117) = 'u'
           dc.b 0 + LOWERCASE      ; CHR$(118) = 'v'
           dc.b 0 + LOWERCASE      ; CHR$(119) = 'w'
           dc.b 0 + LOWERCASE      ; CHR$(120) = 'x'
           dc.b 0 + LOWERCASE      ; CHR$(121) = 'y'
           dc.b 0 + LOWERCASE      ; CHR$(122) = 'z'
           dc.b 0 + PUNCTUATION      ; CHR$(123) = '{'
           dc.b 0 + PUNCTUATION      ; CHR$(124) = '|'
           dc.b 0 + PUNCTUATION      ; CHR$(125) = '}'
           dc.b 0 + PUNCTUATION      ; CHR$(126) = '~'
           dc.b 0 + CONTROL      ; CHR$(127) = '.'
           dc.b 0 + PUNCTUATION      ; CHR$(128) = 'Ä'
           dc.b 0 + PUNCTUATION      ; CHR$(129) = 'Å'
           dc.b 0 + PUNCTUATION      ; CHR$(130) = 'Ç'
           dc.b 0 + PUNCTUATION      ; CHR$(131) = 'É'
           dc.b 0 + PUNCTUATION      ; CHR$(132) = 'Ñ'
           dc.b 0 + PUNCTUATION      ; CHR$(133) = 'Ö'
           dc.b 0 + PUNCTUATION      ; CHR$(134) = 'Ü'
           dc.b 0 + PUNCTUATION      ; CHR$(135) = 'á'
           dc.b 0 + PUNCTUATION      ; CHR$(136) = 'à'
           dc.b 0 + PUNCTUATION      ; CHR$(137) = 'â'
           dc.b 0 + PUNCTUATION      ; CHR$(138) = 'ä'
           dc.b 0 + PUNCTUATION      ; CHR$(139) = 'ã'
           dc.b 0 + PUNCTUATION      ; CHR$(140) = 'å'
           dc.b 0 + PUNCTUATION      ; CHR$(141) = 'ç'
           dc.b 0 + PUNCTUATION      ; CHR$(142) = 'é'
           dc.b 0 + PUNCTUATION      ; CHR$(143) = 'è'
           dc.b 0 + PUNCTUATION      ; CHR$(144) = 'ê'
           dc.b 0 + PUNCTUATION      ; CHR$(145) = 'ë'
           dc.b 0 + PUNCTUATION      ; CHR$(146) = 'í'
           dc.b 0 + PUNCTUATION      ; CHR$(147) = 'ì'
           dc.b 0 + PUNCTUATION      ; CHR$(148) = 'î'
           dc.b 0 + PUNCTUATION      ; CHR$(149) = 'ï'
           dc.b 0 + PUNCTUATION      ; CHR$(150) = 'ñ'
           dc.b 0 + PUNCTUATION      ; CHR$(151) = 'ó'
           dc.b 0 + PUNCTUATION      ; CHR$(152) = 'ò'
           dc.b 0 + PUNCTUATION      ; CHR$(153) = 'ô'
           dc.b 0 + PUNCTUATION      ; CHR$(154) = 'ö'
           dc.b 0 + PUNCTUATION      ; CHR$(155) = 'õ'
           dc.b 0 + PUNCTUATION      ; CHR$(156) = 'ú'
           dc.b 0 + PUNCTUATION      ; CHR$(157) = 'ù'
           dc.b 0 + PUNCTUATION      ; CHR$(158) = 'û'
           dc.b 0 + PUNCTUATION      ; CHR$(159) = 'ü'
           dc.b 0 + PUNCTUATION      ; CHR$(160) = '†'
           dc.b 0 + PUNCTUATION      ; CHR$(161) = '°'
           dc.b 0 + PUNCTUATION      ; CHR$(162) = '¢'
           dc.b 0 + PUNCTUATION      ; CHR$(163) = '£'
           dc.b 0 + PUNCTUATION      ; CHR$(164) = '§'
           dc.b 0 + PUNCTUATION      ; CHR$(165) = '•'
           dc.b 0 + PUNCTUATION      ; CHR$(166) = '¶'
           dc.b 0 + PUNCTUATION      ; CHR$(167) = 'ß'
           dc.b 0 + PUNCTUATION      ; CHR$(168) = '®'
           dc.b 0 + PUNCTUATION      ; CHR$(169) = '©'
           dc.b 0 + PUNCTUATION      ; CHR$(170) = '™'
           dc.b 0 + PUNCTUATION      ; CHR$(171) = '´'
           dc.b 0 + PUNCTUATION      ; CHR$(172) = '¨'
           dc.b 0 + PUNCTUATION      ; CHR$(173) = '≠'
           dc.b 0 + PUNCTUATION      ; CHR$(174) = 'Æ'
           dc.b 0 + PUNCTUATION      ; CHR$(175) = 'Ø'
           dc.b 0 + PUNCTUATION      ; CHR$(176) = '∞'
           dc.b 0 + PUNCTUATION      ; CHR$(177) = '±'
           dc.b 0 + PUNCTUATION      ; CHR$(178) = '≤'
           dc.b 0 + PUNCTUATION      ; CHR$(179) = '≥'
           dc.b 0 + PUNCTUATION      ; CHR$(180) = '¥'
           dc.b 0 + PUNCTUATION      ; CHR$(181) = 'µ'
           dc.b 0 + PUNCTUATION      ; CHR$(182) = '∂'
           dc.b 0 + PUNCTUATION      ; CHR$(183) = '∑'
           dc.b 0 + PUNCTUATION      ; CHR$(184) = '∏'
           dc.b 0 + PUNCTUATION      ; CHR$(185) = 'π'
           dc.b 0 + PUNCTUATION      ; CHR$(186) = '∫'
           dc.b 0 + PUNCTUATION      ; CHR$(187) = 'ª'
           dc.b 0 + PUNCTUATION      ; CHR$(188) = 'º'
           dc.b 0 + PUNCTUATION      ; CHR$(189) = 'Ω'
           dc.b 0 + PUNCTUATION      ; CHR$(190) = 'æ'
           dc.b 0 + PUNCTUATION      ; CHR$(191) = 'ø'
           dc.b 0 + CONTROL      ; CHR$(192) = '.'
           dc.b 0 + CONTROL      ; CHR$(193) = '.'
           dc.b 0 + CONTROL      ; CHR$(194) = '.'
           dc.b 0 + CONTROL      ; CHR$(195) = '.'
           dc.b 0 + CONTROL      ; CHR$(196) = '.'
           dc.b 0 + CONTROL      ; CHR$(197) = '.'
           dc.b 0 + CONTROL      ; CHR$(198) = '.'
           dc.b 0 + CONTROL      ; CHR$(199) = '.'
           dc.b 0 + CONTROL      ; CHR$(200) = '.'
           dc.b 0 + CONTROL      ; CHR$(201) = '.'
           dc.b 0 + CONTROL      ; CHR$(202) = '.'
           dc.b 0 + CONTROL      ; CHR$(203) = '.'
           dc.b 0 + CONTROL      ; CHR$(204) = '.'
           dc.b 0 + CONTROL      ; CHR$(205) = '.'
           dc.b 0 + CONTROL      ; CHR$(206) = '.'
           dc.b 0 + CONTROL      ; CHR$(207) = '.'
           dc.b 0 + CONTROL      ; CHR$(208) = '.'
           dc.b 0 + CONTROL      ; CHR$(209) = '.'
           dc.b 0 + CONTROL      ; CHR$(210) = '.'
           dc.b 0 + CONTROL      ; CHR$(211) = '.'
           dc.b 0 + CONTROL      ; CHR$(212) = '.'
           dc.b 0 + CONTROL      ; CHR$(213) = '.'
           dc.b 0 + CONTROL      ; CHR$(214) = '.'
           dc.b 0 + CONTROL      ; CHR$(215) = '.'
           dc.b 0 + CONTROL      ; CHR$(216) = '.'
           dc.b 0 + CONTROL      ; CHR$(217) = '.'
           dc.b 0 + CONTROL      ; CHR$(218) = '.'
           dc.b 0 + CONTROL      ; CHR$(219) = '.'
           dc.b 0 + CONTROL      ; CHR$(220) = '.'
           dc.b 0 + CONTROL      ; CHR$(221) = '.'
           dc.b 0 + CONTROL      ; CHR$(222) = '.'
           dc.b 0 + CONTROL      ; CHR$(223) = '.'
           dc.b 0 + CONTROL      ; CHR$(224) = '.'
           dc.b 0 + CONTROL      ; CHR$(225) = '.'
           dc.b 0 + CONTROL      ; CHR$(226) = '.'
           dc.b 0 + CONTROL      ; CHR$(227) = '.'
           dc.b 0 + CONTROL      ; CHR$(228) = '.'
           dc.b 0 + CONTROL      ; CHR$(229) = '.'
           dc.b 0 + CONTROL      ; CHR$(230) = '.'
           dc.b 0 + CONTROL      ; CHR$(231) = '.'
           dc.b 0 + CONTROL      ; CHR$(232) = '.'
           dc.b 0 + CONTROL      ; CHR$(233) = '.'
           dc.b 0 + CONTROL      ; CHR$(234) = '.'
           dc.b 0 + CONTROL      ; CHR$(235) = '.'
           dc.b 0 + CONTROL      ; CHR$(236) = '.'
           dc.b 0 + CONTROL      ; CHR$(237) = '.'
           dc.b 0 + CONTROL      ; CHR$(238) = '.'
           dc.b 0 + CONTROL      ; CHR$(239) = '.'
           dc.b 0 + CONTROL      ; CHR$(240) = '.'
           dc.b 0 + CONTROL      ; CHR$(241) = '.'
           dc.b 0 + CONTROL      ; CHR$(242) = '.'
           dc.b 0 + CONTROL      ; CHR$(243) = '.'
           dc.b 0 + CONTROL      ; CHR$(244) = '.'
           dc.b 0 + CONTROL      ; CHR$(245) = '.'
           dc.b 0 + CONTROL      ; CHR$(246) = '.'
           dc.b 0 + CONTROL      ; CHR$(247) = '.'
           dc.b 0 + CONTROL      ; CHR$(248) = '.'
           dc.b 0 + CONTROL      ; CHR$(249) = '.'
           dc.b 0 + CONTROL      ; CHR$(250) = '.'
           dc.b 0 + CONTROL      ; CHR$(251) = '.'
           dc.b 0 + CONTROL      ; CHR$(252) = '.'
           dc.b 0 + CONTROL      ; CHR$(253) = '.'
           dc.b 0 + CONTROL      ; CHR$(254) = '.'
           dc.b 0 + CONTROL      ; CHR$(255) = '.'
           